<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../assets/imagens-hectare/favicon.png" type="image/x-icon">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/propriedade.css">
    <link rel="stylesheet" href="../css/sem-propriedade.css">
    <title>Propriedades</title>
</head>

<body onload="BuscarPropriedades()">
    <div class="propriedade-container" id="propriedadecontainer">
        <aside class="menu-lateral">
            <section class="sessao botoes-principais">
                <button class="botao-menu material-symbols-outlined">Account_Circle</button>
                <button class="botao-menu home material-symbols-outlined">Home</button>
                <button class="botao-menu material-symbols-outlined"
                    onclick="navegar('ticket.html')">Headset</button>
            </section>
            <section class="sessao sair">
                <button class="botao-menu material-symbols-outlined"
                onclick="navegar('../login.html')">Logout</button>
            </section>
        </aside>
        <aside class="caixa-conteudo">
            <header class="cabecalho">
                <div class="caixa-auxiliar-titulo-cabecalho">
                    <section class="sessao-titulo-cabecalho">
                        <h1 id="titulo-cabecalho">Suas Propriedades</h1>
                    </section>
                    <section class="sessao-notificacao-cabecalho">
                        <span class="botao-cabecalho material-symbols-outlined"
                        onclick="mostrarNotificacoes()">Notifications</span>
                    </section>
                </div>
            </header>
            <div class="caixa-notificacoes" id="notificacoes">
                <header class="cabecalho-notificacoes">
                    <h4>Notificações</h4>
                    <h4 class="fechar-notificacoes" onclick="mostrarNotificacoes()">X</h4>
                </header>
                <section class="lista-notificacao">
                    <div class="notificacoes" id="notificacao1">
                        <span class="nivel-notificacao-ruim material-symbols-outlined">Warning</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao1)" class="excluir-notificacao">X</p>
                            <p>Hectare 1 está em estado de alerta!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao2">
                        <span class="nivel-notificacao-ruim material-symbols-outlined">Warning</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao2)" class="excluir-notificacao">X</p>
                            <p>Hectare 2 está em estado de alerta!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao3">
                        <span class="nivel-notificacao-medio material-symbols-outlined">Error</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao3)" class="excluir-notificacao">X</p>
                            <p>Hectare 4 está em estado de atenção!!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao3">
                        <span class="nivel-notificacao-medio material-symbols-outlined">Error</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao3)" class="excluir-notificacao">X</p>
                            <p>Hectare 4 está em estado de atenção!!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao3">
                        <span class="nivel-notificacao-medio material-symbols-outlined">Error</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao3)" class="excluir-notificacao">X</p>
                            <p>Hectare 4 está em estado de atenção!!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao3">
                        <span class="nivel-notificacao-medio material-symbols-outlined">Error</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao3)" class="excluir-notificacao">X</p>
                            <p>Hectare 4 está em estado de atenção!!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                    <div class="notificacoes" id="notificacao3">
                        <span class="nivel-notificacao-medio material-symbols-outlined">Error</span>
                        <section class="descricao-notificacao">
                            <p onclick="excluirNotificacao(notificacao3)" class="excluir-notificacao">X</p>
                            <p>Hectare 4 está em estado de atenção!!</p>
                            <p>16/05/2024</p>
                        </section>
                    </div>
                </section>
            </div>
            <div class="sessao-conteudo-home" id="home">
                <section class="caixa-propriedades" id="CaixaPropriedades">
                    <h2 id="Titulo_Caixa_Propriedades">Propriedades Registradas</h2>
                    <div class="lista-propriedades" id="listapropriedades">

                    </div>
                </section>
            </div>
        </aside>
    </div>
</body>
<script data-jsd-embedded data-key="5b0e0c87-af73-45fd-adc6-46268b98e4c6" data-base-url="https://jsd-widget.atlassian.com" src="https://jsd-widget.atlassian.com/assets/embed.js"></script>
</html>
<script>
     function mostrarNotificacoes(){
        if(notificacoes.style.display == 'none'){
            notificacoes.style.display = 'block'
        } else {
            notificacoes.style.display = 'none'
        }
    }

    function excluirNotificacao(idNotificacao){
        idNotificacao.remove();
    }

     function navegar(pagina){
        window.location.href = pagina;
    }

    function BuscarPropriedades(){
        fetch("/usuarios/BuscarPropriedades", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    fkEmpresa: sessionStorage.fkEmpresa
                }),
            })

                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {


                        resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                        
                        if (json.length == 0){
                            listapropriedades.innerHTML == ""
                            Titulo_Caixa_Propriedades.innerHTML = "OPS!"
                            listapropriedades.innerHTML += `
                            <div class="div-texto">
                                <p class="texto-propriedades">
                                    <b>
                                        Parece que você ainda não tem propriedades cadastradas conosco e nem é funcionário de uma! Cadastre sua propriedade ou peça para seu empregador te adicionar e aproveite nossa solução!
                                    </b>
                                </p>
                                <button class="botao-add-propriedade" onclick="navegar('cadastrar_propriedades.html')">Adicionar Propriedade</button>
                            </div>
                    `
                        }

                        else{
                            let Numero_Propriedade = 0

                            for(let Quantidade_Propriedades = 0; Quantidade_Propriedades < json.length; Quantidade_Propriedades++){
                                let Nome_Propriedade = json[Numero_Propriedade].nome
                                Numero_Propriedade++

                                listapropriedades.innerHTML += `
                                <div class="propriedade" onclick="navegar('hectare.html')">
                                    <div class="nome-propriedade">
                                        <div class="bolinha"></div>
                                        <p>${Nome_Propriedade}</p>
                                    </div>
                                    <div class="opcoes-propriedade">
                                        <span class="configuracoes material-symbols-outlined">Settings</span>
                                        <span class="deletar material-symbols-outlined">Delete</span>
                                    </div>
                                </div>
                                `
                            }
                            listapropriedades.innerHTML += `
                            <button class="adicionar-propriedade" onclick="navegar('cadastrar_propriedades.html')">
                                Adicionar mais propriedades
                            </button>
                            `
                        }

                        });

                    } else {
                        throw "Houve um erro ao tentar realizar o cadastro!";
                    }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);

                });

            return false;

    }
</script>